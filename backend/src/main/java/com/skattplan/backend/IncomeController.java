package com.skattplan.backend;

import org.springframework.web.bind.annotation.*;
import java.util.HashMap;
import java.util.Map;

@RestController
@RequestMapping("/api/skatt")
@CrossOrigin(origins = "http://localhost:3000")
public class IncomeController {

    // Komplett lista över kommuner och skattesatser (exempel, fyll på med resten)
    private static final Map<String, Double> KOMMUN_SKATTESATS = Map.ofEntries(
        Map.entry("Ale", 0.3290),
        Map.entry("Alingsås", 0.3291),
        Map.entry("Alvesta", 0.3322),
        Map.entry("Aneby", 0.3402),
        Map.entry("Arboga", 0.3327),
        Map.entry("Arjeplog", 0.3442),
        Map.entry("Arvidsjaur", 0.3442),
        Map.entry("Arvika", 0.3402),
        Map.entry("Askersund", 0.3375),
        Map.entry("Avesta", 0.3362),
        Map.entry("Bengtsfors", 0.3417),
        Map.entry("Berg", 0.3372),
        Map.entry("Bjurholm", 0.3402),
        Map.entry("Bjuv", 0.3161),
        Map.entry("Boden", 0.3432),
        Map.entry("Bollebygd", 0.3231),
        Map.entry("Bollnäs", 0.3402),
        Map.entry("Borgholm", 0.3352),
        Map.entry("Borlänge", 0.3362),
        Map.entry("Borås", 0.3231),
        Map.entry("Botkyrka", 0.3160),
        Map.entry("Boxholm", 0.3362),
        Map.entry("Bromölla", 0.3202),
        Map.entry("Bräcke", 0.3372),
        Map.entry("Burlöv", 0.3072),
        Map.entry("Båstad", 0.3072),
        Map.entry("Dals-Ed", 0.3417),
        Map.entry("Danderyd", 0.2938),
        Map.entry("Degerfors", 0.3375),
        Map.entry("Dorotea", 0.3402),
        Map.entry("Eda", 0.3402),
        Map.entry("Ekerö", 0.2982),
        Map.entry("Eksjö", 0.3402),
        Map.entry("Emmaboda", 0.3352),
        Map.entry("Enköping", 0.3162),
        Map.entry("Eskilstuna", 0.3232),
        Map.entry("Eslöv", 0.3242),
        Map.entry("Essunga", 0.3291),
        Map.entry("Fagersta", 0.3362),
        Map.entry("Falkenberg", 0.3132),
        Map.entry("Falköping", 0.3291),
        Map.entry("Falun", 0.3362),
        Map.entry("Färgelanda", 0.3417),
        Map.entry("Filipstad", 0.3402),
        Map.entry("Finspång", 0.3362),
        Map.entry("Flen", 0.3232),
        Map.entry("Forshaga", 0.3402),
        Map.entry("Gagnef", 0.3362),
        Map.entry("Gällivare", 0.3442),
        Map.entry("Gävle", 0.3292),
        Map.entry("Gislaved", 0.3322),
        Map.entry("Gnesta", 0.3232),
        Map.entry("Gnosjö", 0.3322),
        Map.entry("Gotland", 0.3371),
        Map.entry("Grums", 0.3402),
        Map.entry("Grästorp", 0.3291),
        Map.entry("Gullspång", 0.3291),
        Map.entry("Göteborg", 0.3260),
        Map.entry("Götene", 0.3291),
        Map.entry("Habo", 0.3362),
        Map.entry("Hagfors", 0.3402),
        Map.entry("Hallsberg", 0.3375),
        Map.entry("Hallstahammar", 0.3327),
        Map.entry("Halmstad", 0.3132),
        Map.entry("Hammarö", 0.3402),
        Map.entry("Haninge", 0.3160),
        Map.entry("Haparanda", 0.3442),
        Map.entry("Heby", 0.3162),
        Map.entry("Hedemora", 0.3362),
        Map.entry("Helsingborg", 0.3062),
        Map.entry("Herrljunga", 0.3291),
        Map.entry("Hjo", 0.3291),
        Map.entry("Hofors", 0.3292),
        Map.entry("Huddinge", 0.3160),
        Map.entry("Hudiksvall", 0.3402),
        Map.entry("Hultsfred", 0.3352),
        Map.entry("Hylte", 0.3132),
        Map.entry("Håbo", 0.3162),
        Map.entry("Hällefors", 0.3375),
        Map.entry("Härjedalen", 0.3372),
        Map.entry("Härnösand", 0.3402),
        Map.entry("Härryda", 0.3231),
        Map.entry("Hässleholm", 0.3242),
        Map.entry("Höganäs", 0.3072),
        Map.entry("Högsby", 0.3352),
        Map.entry("Hörby", 0.3242),
        Map.entry("Höör", 0.3242),
        Map.entry("Jokkmokk", 0.3442),
        Map.entry("Järfälla", 0.3160),
        Map.entry("Jönköping", 0.3362),
        Map.entry("Kalix", 0.3442),
        Map.entry("Kalmar", 0.3352),
        Map.entry("Karlsborg", 0.3291),
        Map.entry("Karlshamn", 0.3202),
        Map.entry("Karlskoga", 0.3375),
        Map.entry("Karlskrona", 0.3202),
        Map.entry("Karlstad", 0.3402),
        Map.entry("Katrineholm", 0.3232),
        Map.entry("Kil", 0.3402),
        Map.entry("Kinda", 0.3362),
        Map.entry("Kiruna", 0.3442),
        Map.entry("Klippan", 0.3242),
        Map.entry("Knivsta", 0.3162),
        Map.entry("Kramfors", 0.3402),
        Map.entry("Kristianstad", 0.3242),
        Map.entry("Kristinehamn", 0.3402),
        Map.entry("Krokom", 0.3372),
        Map.entry("Kumla", 0.3375),
        Map.entry("Kungsbacka", 0.3132),
        Map.entry("Kungsör", 0.3327),
        Map.entry("Kungälv", 0.3231),
        Map.entry("Kävlinge", 0.3072),
        Map.entry("Köping", 0.3327),
        Map.entry("Laholm", 0.3132),
        Map.entry("Landskrona", 0.3062),
        Map.entry("Laxå", 0.3375),
        Map.entry("Lekeberg", 0.3375),
        Map.entry("Leksand", 0.3362),
        Map.entry("Lerum", 0.3231),
        Map.entry("Lessebo", 0.3322),
        Map.entry("Lidingö", 0.2982),
        Map.entry("Lidköping", 0.3291),
        Map.entry("Lilla Edet", 0.3291),
        Map.entry("Lindesberg", 0.3375),
        Map.entry("Linköping", 0.3362),
        Map.entry("Ljungby", 0.3322),
        Map.entry("Ljusdal", 0.3402),
        Map.entry("Ljusnarsberg", 0.3375),
        Map.entry("Lomma", 0.3072),
        Map.entry("Ludvika", 0.3362),
        Map.entry("Luleå", 0.3432),
        Map.entry("Lund", 0.3072),
        Map.entry("Lycksele", 0.3402),
        Map.entry("Lysekil", 0.3291),
        Map.entry("Malmö", 0.3242),
        Map.entry("Malung-Sälen", 0.3362),
        Map.entry("Malå", 0.3402),
        Map.entry("Mariestad", 0.3291),
        Map.entry("Mark", 0.3231),
        Map.entry("Markaryd", 0.3322),
        Map.entry("Mellerud", 0.3417),
        Map.entry("Mjölby", 0.3362),
        Map.entry("Mora", 0.3362),
        Map.entry("Motala", 0.3362),
        Map.entry("Mullsjö", 0.3362),
        Map.entry("Munkedal", 0.3417),
        Map.entry("Munkfors", 0.3402),
        Map.entry("Mölndal", 0.3231),
        Map.entry("Mönsterås", 0.3352),
        Map.entry("Mörbylånga", 0.3352),
        Map.entry("Nacka", 0.2982),
        Map.entry("Nora", 0.3375),
        Map.entry("Norberg", 0.3362),
        Map.entry("Nordanstig", 0.3402),
        Map.entry("Nordmaling", 0.3402),
        Map.entry("Norrköping", 0.3362),
        Map.entry("Norrtälje", 0.3160),
        Map.entry("Norsjö", 0.3402),
        Map.entry("Nybro", 0.3352),
        Map.entry("Nykvarn", 0.3160),
        Map.entry("Nyköping", 0.3232),
        Map.entry("Nynäshamn", 0.3160),
        Map.entry("Nässjö", 0.3322),
        Map.entry("Ockelbo", 0.3292),
        Map.entry("Olofström", 0.3202),
        Map.entry("Orsa", 0.3362),
        Map.entry("Orust", 0.3417),
        Map.entry("Osby", 0.3242),
        Map.entry("Oskarshamn", 0.3352),
        Map.entry("Ovanåker", 0.3402),
        Map.entry("Oxelösund", 0.3232),
        Map.entry("Pajala", 0.3442),
        Map.entry("Partille", 0.3231),
        Map.entry("Perstorp", 0.3242),
        Map.entry("Piteå", 0.3432),
        Map.entry("Ragunda", 0.3372),
        Map.entry("Robertsfors", 0.3402),
        Map.entry("Ronneby", 0.3202),
        Map.entry("Rättvik", 0.3362),
        Map.entry("Sala", 0.3327),
        Map.entry("Salem", 0.3160),
        Map.entry("Sandviken", 0.3292),
        Map.entry("Sigtuna", 0.3160),
        Map.entry("Simrishamn", 0.3242),
        Map.entry("Sjöbo", 0.3242),
        Map.entry("Skara", 0.3291),
        Map.entry("Skellefteå", 0.3402),
        Map.entry("Skinnskatteberg", 0.3362),
        Map.entry("Skurup", 0.3242),
        Map.entry("Skövde", 0.3291),
        Map.entry("Smedjebacken", 0.3362),
        Map.entry("Sollefteå", 0.3402),
        Map.entry("Sollentuna", 0.3160),
        Map.entry("Solna", 0.2982),
        Map.entry("Sorsele", 0.3402),
        Map.entry("Sotenäs", 0.3417),
        Map.entry("Staffanstorp", 0.3072),
        Map.entry("Stenungsund", 0.3231),
        Map.entry("Stockholm", 0.2982),
        Map.entry("Storfors", 0.3402),
        Map.entry("Storuman", 0.3402),
        Map.entry("Strängnäs", 0.3232),
        Map.entry("Strömstad", 0.3417),
        Map.entry("Sundbyberg", 0.2982),
        Map.entry("Sundsvall", 0.3402),
        Map.entry("Sunne", 0.3402),
        Map.entry("Surahammar", 0.3327),
        Map.entry("Svalöv", 0.3242),
        Map.entry("Svedala", 0.3072),
        Map.entry("Svenljunga", 0.3291),
        Map.entry("Säffle", 0.3402),
        Map.entry("Säter", 0.3362),
        Map.entry("Sävsjö", 0.3322),
        Map.entry("Söderhamn", 0.3402),
        Map.entry("Söderköping", 0.3362),
        Map.entry("Södertälje", 0.3160),
        Map.entry("Sölvesborg", 0.3202),
        Map.entry("Tanum", 0.3417),
        Map.entry("Tibro", 0.3291),
        Map.entry("Tidaholm", 0.3291),
        Map.entry("Tierp", 0.3162),
        Map.entry("Timrå", 0.3402),
        Map.entry("Tingsryd", 0.3322),
        Map.entry("Tjörn", 0.3231),
        Map.entry("Tomelilla", 0.3242),
        Map.entry("Torsby", 0.3402),
        Map.entry("Torsås", 0.3352),
        Map.entry("Tranemo", 0.3291),
        Map.entry("Tranås", 0.3362),
        Map.entry("Trelleborg", 0.3072),
        Map.entry("Trollhättan", 0.3231),
        Map.entry("Trosa", 0.3232),
        Map.entry("Tyresö", 0.3160),
        Map.entry("Täby", 0.2982),
        Map.entry("Töreboda", 0.3291),
        Map.entry("Uddevalla", 0.3417),
        Map.entry("Ulricehamn", 0.3291),
        Map.entry("Umeå", 0.3402),
        Map.entry("Upplands-Bro", 0.3160),
        Map.entry("Upplands Väsby", 0.3160),
        Map.entry("Uppsala", 0.3162),
        Map.entry("Uppvidinge", 0.3322),
        Map.entry("Vadstena", 0.3362),
        Map.entry("Vaggeryd", 0.3322),
        Map.entry("Valdemarsvik", 0.3362),
        Map.entry("Vallentuna", 0.2982),
        Map.entry("Vansbro", 0.3362),
        Map.entry("Vara", 0.3291),
        Map.entry("Varberg", 0.3132),
        Map.entry("Vaxholm", 0.2982),
        Map.entry("Vellinge", 0.3072),
        Map.entry("Vetlanda", 0.3322),
        Map.entry("Vilhelmina", 0.3402),
        Map.entry("Vimmerby", 0.3352),
        Map.entry("Vindeln", 0.3402),
        Map.entry("Vingåker", 0.3232),
        Map.entry("Vårgårda", 0.3291),
        Map.entry("Vänersborg", 0.3417),
        Map.entry("Vännäs", 0.3402),
        Map.entry("Värmdö", 0.2982),
        Map.entry("Värnamo", 0.3322),
        Map.entry("Västervik", 0.3352),
        Map.entry("Västerås", 0.3327),
        Map.entry("Växjö", 0.3322),
        Map.entry("Ydre", 0.3362),
        Map.entry("Ystad", 0.3242),
        Map.entry("Åmål", 0.3417),
        Map.entry("Ånge", 0.3402),
        Map.entry("Åre", 0.3372),
        Map.entry("Årjäng", 0.3402),
        Map.entry("Åsele", 0.3402),
        Map.entry("Åstorp", 0.3242),
        Map.entry("Åtvidaberg", 0.3362),
        Map.entry("Älmhult", 0.3322),
        Map.entry("Älvdalen", 0.3362),
        Map.entry("Älkarleby", 0.3292),
        Map.entry("Älvsbyn", 0.3442),
        Map.entry("Ängelholm", 0.3072),
        Map.entry("Öckerö", 0.3231),
        Map.entry("Ödeshög", 0.3362),
        Map.entry("Örebro", 0.3375),
        Map.entry("Örkelljunga", 0.3242),
        Map.entry("Örnsköldsvik", 0.3402),
        Map.entry("Östersund", 0.3372),
        Map.entry("Österåker", 0.2982),
        Map.entry("Östhammar", 0.3162),
        Map.entry("Östra Göinge", 0.3242),
        Map.entry("Överkalix", 0.3442),
        Map.entry("Övertorneå", 0.3442)
    );

    @GetMapping("/beräkna")
    public Map<String, Double> calculateTax(@RequestParam double inkomst, @RequestParam String kommun) {
        double skattesats = KOMMUN_SKATTESATS.getOrDefault(kommun, 0.32); // fallback om kommun ej finns
        double kommunalSkatt = inkomst * skattesats;
        double statligSkatt = inkomst > 540700 ? (inkomst - 540700) * 0.2 : 0;
        double totalSkatt = kommunalSkatt + statligSkatt;

        Map<String, Double> result = new HashMap<>();
        result.put("kommunalSkatt", kommunalSkatt);
        result.put("statligSkatt", statligSkatt);
        result.put("totalSkatt", totalSkatt);
        return result;
    }
}
